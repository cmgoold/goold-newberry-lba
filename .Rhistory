function(x) x[[1]][row_samples[100], context_sample]))
unlist(lapply(adoption_green_preds,
function(x) x[[1]][row_samples[1], context_sample]))
unlist(lapply(adoption_green_preds,
function(x) x[[100]][row_samples[1], context_sample]))
unlist(lapply(adoption_green_preds,
function(x) x[[10]][row_samples[1], context_sample]))
unlist(lapply(adoption_green_preds,
function(x) x[[12]][row_samples[1], context_sample]))
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("a", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
i=1
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=2
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=3
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=4
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=5
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=6
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=7
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=8
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=10
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
i=11
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_green_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("darkolivegreen3", 0.6))
}
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("b", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
i=1
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=2
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=3
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=4
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=5
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=6
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=7
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=8
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=9
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=10
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=11
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=12
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=13
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=14
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
i=15
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
unlist(lapply(adoption_amber_preds,
function(x) x[[14]][row_samples[j], context_sample]))
unlist(lapply(adoption_amber_preds,
function(x) x[[15]][row_samples[j], context_sample]))
unlist(lapply(adoption_pred_list,
function(x) x[[15]][row_samples[j], context_sample]))
get_ordinal_probs(unlist(lapply(adoption_pred_list,
function(x) x[[15]][row_samples[j], context_sample])), mean(draws$sigma))
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("b", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_amber_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_amber_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("darkorange4",0.5), border = scales::alpha("darkorange4",0.5)
)
lines(days_a_grid_Z,
unlist(lapply( adoption_amber_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
# amber codes
png(filename = paste0(figure_path,"/figure_3_b.png"), width=1000, height=1000, res=200)
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("b", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_amber_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_amber_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("darkorange4",0.5), border = scales::alpha("darkorange4",0.5)
)
lines(days_a_grid_Z,
unlist(lapply( adoption_amber_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
dev.off()
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5, adj=0.5)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("c", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), 1, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_red_preds,
function(x) x[[i]][row_samples, context_sample])),
lwd=0.5, col=scales::alpha("tomato", 0.6))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_red_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_red_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("firebrick4",0.5), border = scales::alpha("firebrick4",0.5)
)
lines(days_a_grid_Z,
unlist(lapply( adoption_red_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
# red codes
png(filename = paste0(figure_path,"/figure_3_c.png"), width=1000, height=1000, res=200)
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5, adj=0.5)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("c", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), 1, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_red_preds,
function(x) x[[i]][row_samples, context_sample])),
lwd=0.5, col=scales::alpha("tomato", 0.6))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_red_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_red_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("firebrick4",0.5), border = scales::alpha("firebrick4",0.5)
)
lines(days_a_grid_Z,
unlist(lapply( adoption_red_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
dev.off()
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5, adj=0.5, mar=c(5,4,4,2)+0.1)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("d", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_missing_preds,
function(x) x[[i]][row_samples, context_sample])),
lwd=0.5, col=scales::alpha("steelblue", 0.4))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("steelblue",0.8), border = scales::alpha("steelblue",0.8)
)
lines(days_a_grid_Z,
unlist(lapply(adoption_missing_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5, adj=0.5, mar=c(5,4,4,2)+0.1)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("d", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("steelblue",0.8), border = scales::alpha("steelblue",0.8)
)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_missing_preds,
function(x) x[[i]][row_samples, context_sample])),
lwd=0.5, col=scales::alpha("steelblue", 0.4))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("steelblue",0.8), border = scales::alpha("steelblue",0.8)
)
lines(days_a_grid_Z,
unlist(lapply(adoption_missing_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
# missing codes
png(filename = paste0(figure_path,"/figure_3_d.png"), width=1000, height=1000, res=200)
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5, adj=0.5, mar=c(5,4,4,2)+0.1)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("d", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_missing_preds,
function(x) x[[i]][row_samples, context_sample])),
lwd=0.5, col=scales::alpha("steelblue", 0.4))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_missing_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("steelblue",0.8), border = scales::alpha("steelblue",0.8)
)
lines(days_a_grid_Z,
unlist(lapply(adoption_missing_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
dev.off()
plot(days_a_grid_Z, 1:length(days_a_grid_Z),
type="n", ylim=c(0,1), bty="n", axes = F,
xlab = "days after adoption", ylab = "probability",
cex.lab = 1.5)
axis(side = 1, at = c(min(days_a_grid_Z), median(days_a_grid_Z), max(days_a_grid_Z)),
labels = round(c(min(days_a_grid), median(days_a_grid), max(days_a_grid))),
lwd = 3, cex.axis=1.25)
axis(side = 2, at = seq(0, 1, 0.5), lwd=3,  cex.axis=1.25)
mtext("b", line=0, at=min(days_a_grid_Z), cex = 1.5, font = 2)
for(i in 1:plot_dogs){
row_samples <- sample(1:nrow(draws), n_each_samples, replace = FALSE)
context_sample <- sample(1:8, 1)
for(j in seq_along(row_samples)){
lines(days_a_grid_Z,
unlist(lapply(adoption_amber_preds,
function(x) x[[i]][row_samples[j], context_sample])),
lwd=0.5, col=scales::alpha("orange", 0.6))
}
}
polygon(
x = c(days_a_grid_Z, rev(days_a_grid_Z)),
y = c(
unlist(lapply( adoption_amber_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[1])),
rev(unlist(lapply( adoption_amber_preds, function(x) hdi(unlist(lapply(x, function(z) mean(colMeans(z)))))[2])))
),
col = scales::alpha("darkorange",0.5), border = scales::alpha("darkorange",0.5)
)
lines(days_a_grid_Z,
unlist(lapply( adoption_amber_preds, function(x) mean(unlist(lapply(x, function(z) mean(colMeans(z))))))), col="black", lwd=2)
